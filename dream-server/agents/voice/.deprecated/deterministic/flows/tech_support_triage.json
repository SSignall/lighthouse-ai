{
  "name": "tech_support_triage",
  "initial_state": "S0_greeting",
  "states": {
    "S0_greeting": {
      "say": "greeting",
      "expect": ["password_reset", "connectivity", "hardware", "software", "other"],
      "next": {
        "password_reset": "S1_verify_identity",
        "connectivity": "S2_connectivity_check",
        "hardware": "S3_hardware_triage",
        "software": "S4_software_triage",
        "other": "S_llm_mode"
      }
    },
    "S1_verify_identity": {
      "say": "ask_employee_id",
      "capture": {"employee_id": "text"},
      "expect": ["provide_id"],
      "next": {
        "provide_id": "S1_password_sent"
      }
    },
    "S1_password_sent": {
      "say": "password_reset_sent",
      "final": true
    },
    "S2_connectivity_check": {
      "say": "ask_device_type",
      "capture": {"device_type": "text"},
      "expect": ["laptop", "phone"],
      "next": {
        "laptop": "S2_laptop_steps",
        "phone": "S2_phone_steps",
        "_default": "S2_general_steps"
      }
    },
    "S2_laptop_steps": {
      "say": "connectivity_laptop_steps",
      "expect": ["resolved_yes", "resolved_no"],
      "next": {
        "resolved_yes": "S5_resolved",
        "resolved_no": "S5_escalate"
      }
    },
    "S2_phone_steps": {
      "say": "connectivity_phone_steps",
      "expect": ["resolved_yes", "resolved_no"],
      "next": {
        "resolved_yes": "S5_resolved",
        "resolved_no": "S5_escalate"
      }
    },
    "S2_general_steps": {
      "say": "connectivity_general_steps",
      "expect": ["resolved_yes", "resolved_no"],
      "next": {
        "resolved_yes": "S5_resolved",
        "resolved_no": "S5_escalate"
      }
    },
    "S3_hardware_triage": {
      "say": "ask_hardware_issue",
      "capture": {"hardware_issue": "text"},
      "expect": ["describe_issue"],
      "next": {
        "describe_issue": "S3_ticket_created"
      }
    },
    "S3_ticket_created": {
      "say": "hardware_ticket_created",
      "final": true
    },
    "S4_software_triage": {
      "say": "ask_software_name",
      "capture": {"software_name": "text"},
      "expect": ["provide_name"],
      "next": {
        "provide_name": "S4_software_fix"
      }
    },
    "S4_software_fix": {
      "say": "software_common_fix",
      "expect": ["resolved_yes", "resolved_no"],
      "next": {
        "resolved_yes": "S5_resolved",
        "resolved_no": "S5_escalate"
      }
    },
    "S5_resolved": {
      "say": "glad_helped",
      "final": true
    },
    "S5_escalate": {
      "say": "escalate_ticket",
      "final": true
    },
    "S_llm_mode": {
      "say": "llm_handoff",
      "final": true
    }
  },
  "templates": {
    "greeting": "IT Help Desk, this is the automated assistant. Are you calling about a password reset, connectivity issue, hardware problem, or software issue?",
    "ask_employee_id": "I can help with that password reset. What's your employee ID number?",
    "password_reset_sent": "I've initiated a password reset for employee {employee_id}. You should receive an email with reset instructions within 5 minutes. Is there anything else?",
    "ask_device_type": "Let's troubleshoot that connectivity issue. What type of device are you using - a laptop or phone?",
    "connectivity_laptop_steps": "For laptop connectivity, first try turning Wi-Fi off and back on. If that doesn't work, restart your laptop. Did that resolve the issue?",
    "connectivity_phone_steps": "For your phone, go to Settings, then Wi-Fi, and toggle it off and on. You may also need to forget the network and reconnect. Did that help?",
    "connectivity_general_steps": "Try restarting your device first. If you're still having issues, check that you're connected to the correct network. Did that resolve the issue?",
    "ask_hardware_issue": "I'll create a hardware support ticket for you. Can you briefly describe the hardware issue?",
    "hardware_ticket_created": "I've created a hardware support ticket for: {hardware_issue}. A technician will contact you within 4 business hours. Your ticket number is in the confirmation email. Anything else?",
    "ask_software_name": "Which software application are you having trouble with?",
    "software_common_fix": "For issues with {software_name}, first try closing and reopening the application. If that doesn't work, try restarting your computer. Did that resolve the issue?",
    "glad_helped": "Great! Glad I could help. Have a good day!",
    "escalate_ticket": "I understand. I'm creating a support ticket and a technician will follow up with you within 2 hours. You'll receive a confirmation email shortly.",
    "llm_handoff": "Let me gather some more details about your issue...",
    "fallback": "I'm sorry, I didn't understand. Could you briefly describe your issue again?"
  }
}
